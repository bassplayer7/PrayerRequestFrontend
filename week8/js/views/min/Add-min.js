define(["jquery","HandleBars","PubSub","evt","text!./template/add.html","BootstrapTab"],function($,t,e,i,n){var s=function(){var s=this;this.buttonText=void 0,this.button=void 0,this.getElement=function(){return $("#add_request_input")},this.getButton=function(){return void 0!==this.button?this.button:$("#add_request")},this.registerOpenInputClick=function(){this.getButton().off("click").click(s.showInput.bind(s))},this.registerSubmitRequestClick=function(){this.getButton().off("click").click(s.submitRequest.bind(s))},this.hideInput=function(){this.getElement().remove(),void 0!==this.buttonText&&(this.getButton().text(this.buttonText).removeClass("opened"),this.registerOpenInputClick())},this.addRequest=function(t,n,s){return"string"!=typeof t?!1:void e.publish(i.REQUEST_NEW_INIT,{Title:t,Date:n,Answered:s})},this.submitRequest=function(){var t=this.getElement().val();t&&(this.addRequest(t),this.hideInput())},this.keyActions=function(t){t.keydown(function(t){13===t.which&&s.submitRequest.call(s),27===t.which&&s.hideInput()})},this.showInput=function(){var e=t.compile($(n).html()),i=this.getButton();this.buttonText=this.getButton().text(),this.button=i,i.before(e),i.text("Save").addClass("opened"),this.registerSubmitRequestClick(),this.keyActions(i.parent()),this.getElement().focus()},this.setup=function(){this.registerOpenInputClick(),$(document).keydown(function(t){$(":focus").is("input")||(67===t.which?(t.preventDefault(),s.showInput.apply(s)):85===t.which?(t.preventDefault(),$('.nav-tabs a[href="#unanswered"]').tab("show")):65===t.which&&(t.preventDefault(),$('.nav-tabs a[href="#answered"]').tab("show")))})},this.setup()};return s});